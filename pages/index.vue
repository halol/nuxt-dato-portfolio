<template>
  <div class="page-home">
    <div
      class="bg-primary h-screen w-full flex align-middle items-center relative overflow-hidden"
    >
      <div class="absolute z-0 h-full w-full">
        <svg
          class=" object-center"
          viewBox="0 0 200 200"
          xmlns="http://www.w3.org/2000/svg"
        >
          <rect
            width="70"
            height="100"
            class="stroke-current text-yellow-400"
            fill="none"
            stroke-width="1"
            vector-effect="non-scaling-stroke"
            transform="translate(50 50)"
          ></rect>
          <path
            id="blob2"
            vector-effect="non-scaling-stroke"
            class="stroke-current	text-yellow-400"
            fill="none"
            d="M38,-45.4C53.9,-32,74.4,-24.4,78.5,-12.2C82.5,-0.1,70,16.6,59.4,33.6C48.7,50.7,40,68.2,27.4,70.9C14.8,73.6,-1.6,61.5,-17.5,53.4C-33.3,45.3,-48.6,41.1,-58,30.7C-67.3,20.2,-70.8,3.6,-69.2,-13.4C-67.6,-30.3,-61,-47.6,-48.7,-61.6C-36.3,-75.6,-18.1,-86.4,-3.5,-82.2C11.1,-78,22.2,-58.8,38,-45.4Z"
            transform="translate(50 100)"
          >
            <animate
              attributeName="d"
              attributeType="XML"
              values="M38,-45.4C53.9,-32,74.4,-24.4,78.5,-12.2C82.5,-0.1,70,16.6,59.4,33.6C48.7,50.7,40,68.2,27.4,70.9C14.8,73.6,-1.6,61.5,-17.5,53.4C-33.3,45.3,-48.6,41.1,-58,30.7C-67.3,20.2,-70.8,3.6,-69.2,-13.4C-67.6,-30.3,-61,-47.6,-48.7,-61.6C-36.3,-75.6,-18.1,-86.4,-3.5,-82.2C11.1,-78,22.2,-58.8,38,-45.4Z ; M37.8,-37.1C54.2,-31.3,76.1,-24.3,81.4,-11.8C86.6,0.7,75,18.7,61.7,29.9C48.4,41.2,33.4,45.8,17.6,53.8C1.9,61.9,-14.5,73.4,-31.7,73.2C-48.9,73,-66.8,60.9,-73.4,44.7C-80.1,28.4,-75.5,8,-70.3,-10.8C-65.1,-29.6,-59.3,-46.6,-47.4,-53.2C-35.6,-59.8,-17.8,-55.9,-3.5,-51.6C10.7,-47.4,21.4,-42.9,37.8,-37.1Z ; M38,-45.4C53.9,-32,74.4,-24.4,78.5,-12.2C82.5,-0.1,70,16.6,59.4,33.6C48.7,50.7,40,68.2,27.4,70.9C14.8,73.6,-1.6,61.5,-17.5,53.4C-33.3,45.3,-48.6,41.1,-58,30.7C-67.3,20.2,-70.8,3.6,-69.2,-13.4C-67.6,-30.3,-61,-47.6,-48.7,-61.6C-36.3,-75.6,-18.1,-86.4,-3.5,-82.2C11.1,-78,22.2,-58.8,38,-45.4Z"
              dur="60s"
              repeatCount="indefinite"
              repeatDur="indefinite"
            />
          </path>
          <path
            id="blob1"
            vector-effect="non-scaling-stroke"
            class="fill-current	text-yellow-400"
            d="M34.4,-46.7C43.5,-40.8,49.1,-29.3,56.7,-16C64.4,-2.7,74.2,12.3,71.9,24.6C69.6,36.9,55.2,46.6,41.2,51.5C27.2,56.5,13.6,56.8,0.9,55.6C-11.8,54.3,-23.5,51.4,-35.7,45.9C-48,40.3,-60.6,32.1,-65.1,20.6C-69.6,9.2,-65.8,-5.5,-62.6,-21.9C-59.4,-38.3,-56.8,-56.5,-46.5,-62.1C-36.2,-67.7,-18.1,-60.6,-2.7,-56.9C12.7,-53.1,25.3,-52.7,34.4,-46.7Z"
            transform="translate(30 100)"
          >
            <animate
              attributeName="d"
              attributeType="XML"
              values="M34.4,-46.7C43.5,-40.8,49.1,-29.3,56.7,-16C64.4,-2.7,74.2,12.3,71.9,24.6C69.6,36.9,55.2,46.6,41.2,51.5C27.2,56.5,13.6,56.8,0.9,55.6C-11.8,54.3,-23.5,51.4,-35.7,45.9C-48,40.3,-60.6,32.1,-65.1,20.6C-69.6,9.2,-65.8,-5.5,-62.6,-21.9C-59.4,-38.3,-56.8,-56.5,-46.5,-62.1C-36.2,-67.7,-18.1,-60.6,-2.7,-56.9C12.7,-53.1,25.3,-52.7,34.4,-46.7Z ; M48.1,-68.5C58,-59.1,58.7,-39.2,63.1,-21.5C67.6,-3.7,75.8,11.8,72.4,23.8C68.9,35.9,53.7,44.4,39.7,55.4C25.7,66.3,12.8,79.5,1.6,77.3C-9.6,75.1,-19.2,57.3,-33.5,46.5C-47.9,35.7,-67,31.9,-72.1,22C-77.2,12.2,-68.3,-3.5,-58,-13.8C-47.7,-24,-36,-28.7,-26.1,-38.1C-16.2,-47.5,-8.1,-61.6,5.5,-69.2C19.1,-76.7,38.3,-77.9,48.1,-68.5Z ; M40.3,-45.7C53.7,-45.8,67.1,-35.9,74,-22.2C80.9,-8.5,81.5,9,76.6,25.2C71.8,41.4,61.7,56.2,48,65C34.4,73.9,17.2,76.9,4.1,71.3C-9,65.7,-18,51.5,-29.4,41.8C-40.8,32.2,-54.6,27.2,-60.3,17.7C-66,8.2,-63.7,-5.9,-57.4,-16.6C-51.1,-27.3,-40.9,-34.7,-30.6,-35.7C-20.4,-36.6,-10.2,-31.1,1.6,-33.4C13.5,-35.6,26.9,-45.6,40.3,-45.7Z ; M34.4,-46.7C43.5,-40.8,49.1,-29.3,56.7,-16C64.4,-2.7,74.2,12.3,71.9,24.6C69.6,36.9,55.2,46.6,41.2,51.5C27.2,56.5,13.6,56.8,0.9,55.6C-11.8,54.3,-23.5,51.4,-35.7,45.9C-48,40.3,-60.6,32.1,-65.1,20.6C-69.6,9.2,-65.8,-5.5,-62.6,-21.9C-59.4,-38.3,-56.8,-56.5,-46.5,-62.1C-36.2,-67.7,-18.1,-60.6,-2.7,-56.9C12.7,-53.1,25.3,-52.7,34.4,-46.7Z"
              dur="60s"
              repeatCount="indefinite"
              repeatDur="indefinite"
            />
          </path>
        </svg>
      </div>
      <div class="p-8 sm:p-16 2xl:p-32">
        <div class="space-y-4 sm:max-w-5xl relative z-50">
          <p class="font-light text-xl sm:text-2xl appear delay" data-count="1">
            {{ header.introduction }}
          </p>
          <h1
            class="text-2xl sm:text-4xl lg:text-6xl font-medium -ml-1 appear delay"
            data-count="2"
            style="line-height: 1.2"
          >
            {{ header.headline }}
          </h1>
          <div class="relative">
            <svg
              class="stroke-current text-black animate-arrow"
              width="32"
              height="32"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M12 5V19"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M19 12L12 19L5 12"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </div>
        </div>
      </div>
    </div>
    <main class="relative page-index pt-8 sm:pt-0 px-8 sm:px-16 2xl:p-32">
      <section class="space-y-16 sm:space-y-0 mb-24 sm:mb-0">
        <div v-for="(project, index) in projects" v-bind:key="project.slug">
          <item-project
            v-if="index < 5"
            :project="project"
            class="flex lg:h-screen space-y-4 sm:space-y-0"
            :class="
              index % 2 === 0
                ? 'flex-col sm:flex-row'
                : 'flex-col sm:flex-row-reverse'
            "
          >
          </item-project>
          <item-project-small
            v-else
            :project="project"
            class="mx-auto mb-12 max-w-4xl"
          ></item-project-small>
        </div>
      </section>
    </main>
    <app-footer :footer="footer"></app-footer>
  </div>
</template>

<script>
import { request, gql, imageFields, seoMetaTagsFields } from '~/lib/datocms'
import { toHead } from 'vue-datocms'
import AppFooter from '~/components/shared/AppFooter'
import ItemProject from '~/components/lists/ItemProject'
import ItemProjectSmall from '~/components/lists/ItemProjectSmall'

//import parseISO from 'date-fns/parseISO'

export default {
  transition: 'home',
  components: { AppFooter, ItemProject, ItemProjectSmall },
  async asyncData({ params }) {
    const data = await request({
      query: gql`
        {
          site: _site {
            favicon: faviconMetaTags {
              ...seoMetaTagsFields
            }
          }
          header: header {
            seo: _seoMetaTags {
              ...seoMetaTagsFields
            }
            introduction
            headline
            currentRole
          }
          footer: footer {
            callout
            title
            socialMedia {
              id
              name
              url
            }
          }

          projects: allProjects(
            orderBy: year_DESC
            filter: { active: { eq: "true" } }
          ) {
            name
            slug
            year
            active
            blurb
            cover {
              responsiveImage {
                ...imageFields
              }
            }
            role {
              company {
                name
              }
            }
          }
        }
        ${imageFields}
        ${seoMetaTagsFields}
      `
    })

    return { ready: !!data, ...data }
  },

  head() {
    if (!this.ready) {
      return
    }

    return toHead(this.header.seo, this.site.favicon)
  }
}
</script>
<style scoped>
.animate-arrow {
  animation: arrow 2s infinite alternate ease-in-out;
  position: relative;
}

@keyframes arrow {
  from {
    top: 0;
  }
  to {
    top: 32px;
  }
}
</style>
